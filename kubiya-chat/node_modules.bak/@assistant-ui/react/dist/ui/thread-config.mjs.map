{"version":3,"sources":["../../src/ui/thread-config.tsx"],"sourcesContent":["\"use client\";\n\nimport {\n  ComponentType,\n  FC,\n  PropsWithChildren,\n  ReactNode,\n  createContext,\n  useContext,\n} from \"react\";\n\nimport { AssistantRuntime } from \"../api/AssistantRuntime\";\nimport { AvatarProps } from \"./base/avatar\";\nimport {\n  EmptyContentPartComponent,\n  TextContentPartComponent,\n  ToolCallContentPartProps,\n} from \"../types\";\nimport { AssistantRuntimeProvider } from \"../context\";\nimport { AssistantToolUI } from \"../model-config\";\nimport { useAssistantRuntime } from \"../context/react/AssistantContext\";\n\nexport type SuggestionConfig = {\n  text?: ReactNode | undefined;\n  prompt: string;\n};\n\nexport type ThreadWelcomeConfig = {\n  message?: string | null | undefined;\n  suggestions?: SuggestionConfig[] | undefined;\n};\n\nexport type UserMessageConfig = {\n  allowEdit?: boolean | undefined;\n};\n\nexport type AssistantMessageConfig = {\n  allowReload?: boolean | undefined;\n  allowCopy?: boolean | undefined;\n  allowSpeak?: boolean | undefined;\n  allowFeedbackPositive?: boolean | undefined;\n  allowFeedbackNegative?: boolean | undefined;\n  components?:\n    | {\n        Text?: TextContentPartComponent | undefined;\n        Empty?: EmptyContentPartComponent | undefined;\n        ToolFallback?: ComponentType<ToolCallContentPartProps> | undefined;\n      }\n    | undefined;\n};\n\nexport type BranchPickerConfig = {\n  allowBranchPicker?: boolean | undefined;\n};\n\nexport type ComposerConfig = {\n  allowAttachments?: boolean | undefined;\n};\n\nexport type StringsConfig = {\n  assistantModal?: {\n    open: {\n      button: {\n        tooltip?: string | undefined;\n      };\n    };\n    closed: {\n      button: {\n        tooltip?: string | undefined;\n      };\n    };\n  };\n  threadList?: {\n    new?: {\n      label?: string | undefined;\n    };\n    item?: {\n      title?: {\n        fallback?: string | undefined;\n      };\n      archive?: {\n        tooltip?: string | undefined;\n      };\n    };\n  };\n  thread?: {\n    scrollToBottom?: {\n      tooltip?: string | undefined;\n    };\n  };\n  welcome?: {\n    message?: string | undefined;\n  };\n  userMessage?: {\n    edit?: {\n      tooltip?: string | undefined;\n    };\n  };\n  assistantMessage?: {\n    reload?: {\n      tooltip?: string | undefined;\n    };\n    copy?: {\n      tooltip?: string | undefined;\n    };\n    speak?: {\n      tooltip?: string | undefined;\n      stop?: {\n        tooltip?: string | undefined;\n      };\n    };\n    feedback?: {\n      positive?: {\n        tooltip?: string | undefined;\n      };\n      negative?: {\n        tooltip?: string | undefined;\n      };\n    };\n  };\n  branchPicker?: {\n    previous?: {\n      tooltip?: string | undefined;\n    };\n    next?: {\n      tooltip?: string | undefined;\n    };\n  };\n  composer?: {\n    send?:\n      | {\n          tooltip?: string | undefined;\n        }\n      | undefined;\n    cancel?:\n      | {\n          tooltip?: string | undefined;\n        }\n      | undefined;\n    addAttachment?:\n      | {\n          tooltip?: string | undefined;\n        }\n      | undefined;\n    removeAttachment?: {\n      tooltip?: string | undefined;\n    };\n    input?: {\n      placeholder?: string | undefined;\n    };\n  };\n  editComposer?: {\n    send?: {\n      label?: string | undefined;\n    };\n    cancel?: {\n      label?: string | undefined;\n    };\n  };\n  code?: {\n    header?: {\n      copy?: {\n        tooltip?: string | undefined;\n      };\n    };\n  };\n};\n\nconst ThreadConfigContext = createContext<ThreadConfig>({});\n\nexport type ThreadConfig = {\n  runtime?: AssistantRuntime | undefined;\n\n  assistantAvatar?: AvatarProps | undefined;\n\n  welcome?: ThreadWelcomeConfig | undefined;\n  assistantMessage?: AssistantMessageConfig | undefined;\n  userMessage?: UserMessageConfig | undefined;\n\n  branchPicker?: BranchPickerConfig | undefined;\n\n  composer?: ComposerConfig | undefined;\n\n  strings?: StringsConfig | undefined;\n\n  tools?: AssistantToolUI[] | undefined; // TODO add AssistantTool support\n\n  components?:\n    | {\n        UserMessage?: ComponentType | undefined;\n        AssistantMessage?: ComponentType | undefined;\n        EditComposer?: ComponentType | undefined;\n        Composer?: ComponentType | undefined;\n        ThreadWelcome?: ComponentType | undefined;\n      }\n    | undefined;\n};\n\nexport const useThreadConfig = (): Omit<ThreadConfig, \"runtime\"> => {\n  return useContext(ThreadConfigContext);\n};\n\nexport type ThreadConfigProviderProps = PropsWithChildren<{\n  config?: ThreadConfig | undefined;\n}>;\n\nexport const ThreadConfigProvider: FC<ThreadConfigProviderProps> = ({\n  children,\n  config,\n}) => {\n  const hasAssistant = !!useAssistantRuntime({ optional: true });\n\n  const hasConfig = config && Object.keys(config).length > 0;\n  const outerConfig = useThreadConfig();\n\n  if (hasConfig && Object.keys(outerConfig).length > 0) {\n    throw new Error(\n      \"You are providing ThreadConfig to several nested components. Please provide all configuration to the same component.\",\n    );\n  }\n\n  const configProvider = hasConfig ? (\n    <ThreadConfigContext.Provider value={config}>\n      {children}\n    </ThreadConfigContext.Provider>\n  ) : (\n    <>{children}</>\n  );\n\n  if (!config?.runtime) return configProvider;\n\n  if (hasAssistant) {\n    throw new Error(\n      \"You provided a runtime to <Thread> while simulataneously using <AssistantRuntimeProvider>. This is not allowed.\",\n    );\n  }\n  return (\n    <AssistantRuntimeProvider runtime={config.runtime}>\n      {configProvider}\n    </AssistantRuntimeProvider>\n  );\n};\n\nThreadConfigProvider.displayName = \"ThreadConfigProvider\";\n"],"mappings":";;;AAEA;AAAA,EAKE;AAAA,EACA;AAAA,OACK;AASP,SAAS,gCAAgC;AAEzC,SAAS,2BAA2B;AA0MhC,SAIA,UAJA;AAtDJ,IAAM,sBAAsB,cAA4B,CAAC,CAAC;AA8BnD,IAAM,kBAAkB,MAAqC;AAClE,SAAO,WAAW,mBAAmB;AACvC;AAMO,IAAM,uBAAsD,CAAC;AAAA,EAClE;AAAA,EACA;AACF,MAAM;AACJ,QAAM,eAAe,CAAC,CAAC,oBAAoB,EAAE,UAAU,KAAK,CAAC;AAE7D,QAAM,YAAY,UAAU,OAAO,KAAK,MAAM,EAAE,SAAS;AACzD,QAAM,cAAc,gBAAgB;AAEpC,MAAI,aAAa,OAAO,KAAK,WAAW,EAAE,SAAS,GAAG;AACpD,UAAM,IAAI;AAAA,MACR;AAAA,IACF;AAAA,EACF;AAEA,QAAM,iBAAiB,YACrB,oBAAC,oBAAoB,UAApB,EAA6B,OAAO,QAClC,UACH,IAEA,gCAAG,UAAS;AAGd,MAAI,CAAC,QAAQ,QAAS,QAAO;AAE7B,MAAI,cAAc;AAChB,UAAM,IAAI;AAAA,MACR;AAAA,IACF;AAAA,EACF;AACA,SACE,oBAAC,4BAAyB,SAAS,OAAO,SACvC,0BACH;AAEJ;AAEA,qBAAqB,cAAc;","names":[]}